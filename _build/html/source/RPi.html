
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Making Raspberry Pi usable &#8212; tutos 0.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simple GitHub repo and ReadTheDocs set up" href="git_rtd.html" />
    <link rel="prev" title="Installing Arch Linux on laptop and how to make it usable" href="Arch.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="git_rtd.html" title="Simple GitHub repo and ReadTheDocs set up"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Arch.html" title="Installing Arch Linux on laptop and how to make it usable"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">tutos 0.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Making Raspberry Pi usable</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="making-raspberry-pi-usable">
<h1>Making Raspberry Pi usable<a class="headerlink" href="#making-raspberry-pi-usable" title="Permalink to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>After 8 months of using RPi, I decided to make second version of this tutorial for same
people as I’m - who looks for easy, understandable way to make RPi as
awesome as possible. Several things have changed since last realease of this tutorial, so I decided to rewrite some parts and also to delete some parts which are not necessary today.</p>
<p>In this tutorial I will walk you through whole process of making from
Raspberry Pi secure, reliable, efficient, fast and easy to maintain
server for variable purposes as is FTP, web hosting, sharing… All
that thanks to Arch Linux ARM operating system. The device will be
“headless” - it means, there will be no fancy windows etc., just command
line. Don’t be scared, I will walk you through and you’ll thank me then
:) . You don’t need some special knowledge about computers and linux
systems.</p>
</section>
<section id="what-you-get">
<h2>What you get<a class="headerlink" href="#what-you-get" title="Permalink to this heading">¶</a></h2>
<p>From “bare” RPi you’ll get:</p>
<ul class="simple">
<li><p>Safely to connect to your RPi from anywhere</p></li>
<li><p>Possibility of hosting web pages, files, etc.</p></li>
<li><p>Readable and reliable system (it will do what you want and nothing
more)</p></li>
</ul>
</section>
<section id="what-you-will-need">
<h2>What you will need<a class="headerlink" href="#what-you-will-need" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Raspberry Pi (doesn’t matter which model) with power supply</p></li>
<li><p>SD Card as a main hardisk for RPi</p></li>
<li><p>SD Card reader on computer with internet access</p></li>
<li><p>Ethernet LAN cable or USB Wi-Fi bundle</p></li>
<li><p>Other computer (preferably with linux, but nevermind if you use
Windows or Mac)</p></li>
<li><p>Possibility to physically get to your router and know credentials to
login to it (or have contact to your network administrator :) )</p></li>
<li><p>Few hours of work</p></li>
</ul>
</section>
<section id="what-you-don-t-need">
<h2>What you don’t need<a class="headerlink" href="#what-you-don-t-need" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Monitor or ability to connect RPi to some monitor</p></li>
<li><p>Keyboard or mouse connected to your RPi</p></li>
</ul>
</section>
<section id="start">
<h2>Start<a class="headerlink" href="#start" title="Permalink to this heading">¶</a></h2>
<p>So you have just bare RPi, SD card, power supply, ethernet cable
(RJ-45). So let’s start! There are houndreds of guides, but I haven’t
found them satisfaing.</p>
<section id="installing-arch-linux-arm-to-sd-card">
<h3>Installing Arch Linux ARM to SD card<a class="headerlink" href="#installing-arch-linux-arm-to-sd-card" title="Permalink to this heading">¶</a></h3>
<p>Go <a class="reference external" href="http://ArchLinuxarm.org/platforms/armv6/raspberry-pi">here</a>, choose installation and
make first 3 steps. That’s it! You have done it. You have you Arch Linux
ARM SD card :)</p>
</section>
<section id="little-networking">
<h3>Little networking<a class="headerlink" href="#little-networking" title="Permalink to this heading">¶</a></h3>
<p>I guess you probably have some of “home router” (“box with internet”)
and when you want to connect e.g by Wi-Fi with your laptop or mobile
phone, it just connects (after inserting password). You need to test
first what happens, when you try to connect by ethernet cable, for
example with your laptop. Turn off Wi-Fi and check it. Did your computer
connects to the network (or even internet) as usuall?</p>
<p>If yes, it is great! You can procced. It is what we need - we need RPi,
when it boots up, to automatically connect to the network. Then we will
able to connect to it. You will need one more thing to find out - which
IP address does router assign to you when you connect by cable - it is very
probable that RPi will get very similiar. Don’t be afraid - it
is easy to get <a class="reference external" href="http://apple.stackexchange.com/questions/19783/how-do-i-know-the-ip-addresses-of-other-computers-in-my-network">IP address</a>. On modern systems,
one command :) .</p>
<p>Ok, now you have to insert SD card to RPi and connect it to your router
with ethernet cable and then turn RPi on by inserting power supply. The
diods start flashing. Now back to your computer and we will try to
connect it using <strong>SSH</strong>. SSH is just “magic power” which enables to
connect to another computer.</p>
<p>RPi is already ready and waits for SSH connection. How to use SSH is supereasy - you will
find a tons of tutorials on the internet (keywords: how to use ssh). IP
address is the probably the one you assigned before. It will be
something like this: <code class="docutils literal notranslate"><span class="pre">192.168.0.x</span></code>, <code class="docutils literal notranslate"><span class="pre">10.0.0.14x</span></code> or similar. Next
thing you need is username. It’s just “root” (and password also).</p>
<p>If your RPi haven’t got this address (ssh is not working), than there
are two options.</p>
<ol class="arabic simple">
<li><p>You will login to your router settings and find out list of all
connected devices with IP addresses and try them.</p></li>
<li><p>Use
<a class="reference external" href="http://www.cyberciti.biz/networking/nmap-command-examples-tutorials/">nmap</a>
to find active devices in your network.</p></li>
</ol>
<p><strong>Example</strong> You have this address assigned: <code class="docutils literal notranslate"><span class="pre">192.168.0.201</span></code>. Then you
have to type (in linux): <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">root&#64;192.168.0.201</span></code>.</p>
<p>You should now end up in RPi console.</p>
<p>Enough of networking for now. We’ll set a proper network configuration later in this guide, but first some <em>musthaves</em>.</p>
</section>
</section>
<section id="first-setup">
<h2>First setup<a class="headerlink" href="#first-setup" title="Permalink to this heading">¶</a></h2>
<p>This is covered over the internet, so I will just redirect you.
<a class="reference external" href="http://elinux.org/ArchLinux_Install_Guide">elinux</a> - from this guide
finish these parts (in RPi console):</p>
<ul class="simple">
<li><p>Change root password</p></li>
<li><p>Modify system files</p></li>
<li><p>Mount extra partitions (if you don’t know what it is, nevermind)</p></li>
<li><p>Update system</p></li>
<li><p>Install sudo</p></li>
<li><p>Create regular user account</p></li>
</ul>
<p>My usuall procedure (which is strongly related to my needs!):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">passwd</span>  <span class="c1"># change root password to something important</span>
<span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">localtime</span>  <span class="c1"># dont care about this</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">zoneinfo</span><span class="o">/</span><span class="n">Europe</span><span class="o">/</span><span class="n">Prague</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">localtime</span>  <span class="c1"># set appropriate timezone</span>
<span class="n">echo</span> <span class="s2">&quot;my_raspberry&quot;</span> <span class="o">&gt;</span>  <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hostname</span>  <span class="c1"># set name of your RPi</span>

<span class="n">useradd</span> <span class="o">-</span><span class="n">m</span> <span class="o">-</span><span class="n">aG</span> <span class="n">wheel</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span> <span class="n">common_user</span> <span class="c1">#</span>
<span class="n">groupadd</span> <span class="n">webdata</span>  <span class="c1"># for sharing</span>
<span class="n">useradd</span> <span class="o">-</span><span class="n">M</span> <span class="o">-</span><span class="n">aG</span> <span class="n">webdata</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">false</span> <span class="n">nginx</span>
<span class="n">usermod</span> <span class="o">-</span><span class="n">aG</span> <span class="n">webdata</span> <span class="n">common_user</span>

<span class="n">visudo</span>  <span class="c1"># uncomment this line:  %wheel ALL=(ALL) ALL</span>

<span class="n">pacman</span> <span class="o">-</span><span class="n">Syu</span>
</pre></div>
</div>
<p>That’s enough for now. Logout from ssh (type <code class="docutils literal notranslate"><span class="pre">exit</span></code>) and connect
again, but as user who was created. Similiar to previous:
<code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">common_user&#64;ip.address</span></code>. From now, you’ll need to type “sudo” in
front of every command, which is possibly danger. I will warn you in
next chapter.</p>
<p>We must be sure that after reboot RPi will reconnect.</p>
<p>Now try if you are connected to the internet. Type <code class="docutils literal notranslate"><span class="pre">ping</span> <span class="pre">8.8.8.8</span></code>. If
you don’t see <code class="docutils literal notranslate"><span class="pre">ping:</span> <span class="pre">unknown</span> <span class="pre">host</span> <span class="pre">8.8.8.8</span></code> it’s good! If you do, your
internet connection is not working. Try to find out why - unfortunately
it is not possible to solve it here.</p>
<p><strong>Warning</strong> Try also <code class="docutils literal notranslate"><span class="pre">ping</span> <span class="pre">google.com</span></code>. It may not work even pinging
8.8.8.8 worked. The reason is bad DNS servers (doesn’t matter what it
is). To solve this you have to find “DNS servers of your IPS”. Try to
google it. If you find them, add them to <code class="docutils literal notranslate"><span class="pre">resolv.conf</span></code>.</p>
<p>Reboot you rpi using <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">reboot</span></code>. You must be able to connect
to it again after one minute. If not, somthing is wrong… In that case,
you need to find out why connection stoped working - if you have
keyboard and monitor, you can repair it. If not, you can try to edit
mistake on other computer by inserting SD card. Otherwise, reinstall…</p>
</section>
<section id="installing-some-sugar-candy">
<h2>Installing some sugar candy<a class="headerlink" href="#installing-some-sugar-candy" title="Permalink to this heading">¶</a></h2>
<p>For our purpouses we will install usefull things, which will help as
maintaing the system. So, run this:
<code class="docutils literal notranslate"><span class="pre">pacman</span> <span class="pre">-S</span> <span class="pre">vim</span> <span class="pre">zsh</span> <span class="pre">wget</span> <span class="pre">ranger</span> <span class="pre">htop</span> <span class="pre">lynx</span></code></p>
<p>Do you see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">error</span><span class="p">:</span> <span class="n">you</span> <span class="n">cannot</span> <span class="n">perform</span> <span class="n">this</span> <span class="n">operation</span> <span class="n">unless</span> <span class="n">you</span> <span class="n">are</span> <span class="n">root</span><span class="o">.</span>
</pre></div>
</div>
<p>Then you need to type <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">pacman</span> <span class="pre">-S</span> <span class="pre">...</span></code>. I will not write it in
future and it is not in other guides. So sometimes you might be confused
whel you’ll read some tutorials and autor implicitly use sudo without
mentioning it.</p>
<p>We will also need these in next chapters:
<code class="docutils literal notranslate"><span class="pre">pacman</span> <span class="pre">-S</span> <span class="pre">nginx</span> <span class="pre">sshguard</span> <span class="pre">vsftpd</span></code></p>
<p>You can notice that is really few packages! And thats true! Isn’t it
great? No needs of tons of crap in your device.</p>
<p>What are these? Just short summary - you can find more about it in
manual pages (<code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">&lt;name_of_pacakge&gt;</span></code>) or find something usefull on
the internet. * <strong>vim</strong> - powerfull text editor (that’s what you will
do 99% of time). First few <em>days</em> are horrible, but keep using it :) .
* <strong>zsh</strong> - doesn’t matter. Just install it and install
<a class="reference external" href="https://github.com/robbyrussell/oh-my-zsh">this</a> * <strong>wget</strong> - just
for downloading things without browser * <strong>ranger</strong> - file manager (you
can browse files, folders…) * <strong>htop</strong> - task manager - you can see
what tasks are running, how much CPU/MEM is used, kill processes and so
on * <strong>lynx</strong> - browser - no kidding :)</p>
</section>
<section id="some-configurations">
<h2>Some configurations<a class="headerlink" href="#some-configurations" title="Permalink to this heading">¶</a></h2>
<p>I assume you installed <code class="docutils literal notranslate"><span class="pre">zsh</span></code> with <code class="docutils literal notranslate"><span class="pre">oh-my-zsh</span></code> (changed your shell)
and also vim. You are connected as created user (from now, I will name
him <strong>bob</strong>). You are in Bob’s home directory - check it with typing
<code class="docutils literal notranslate"><span class="pre">pwd</span></code>. It will print <code class="docutils literal notranslate"><span class="pre">/home/bob</span></code>.</p>
<section id="make-vim-usable">
<h3>Make vim usable<a class="headerlink" href="#make-vim-usable" title="Permalink to this heading">¶</a></h3>
<p>Edit .vimrc file: <code class="docutils literal notranslate"><span class="pre">vim</span> <span class="pre">.vimrc</span></code> and insert this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">syntax</span> <span class="n">on</span>
<span class="nb">set</span> <span class="n">number</span>
<span class="nb">set</span> <span class="n">ruler</span>
<span class="nb">set</span> <span class="n">nocompatible</span>
<span class="nb">set</span> <span class="n">ignorecase</span>
<span class="nb">set</span> <span class="n">backspace</span><span class="o">=</span><span class="n">eol</span><span class="p">,</span><span class="n">start</span><span class="p">,</span><span class="n">indent</span>
<span class="nb">set</span> <span class="n">whichwrap</span><span class="o">+=&lt;</span><span class="p">,</span><span class="o">&gt;</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">l</span>
<span class="nb">set</span> <span class="n">smartcase</span>
<span class="nb">set</span> <span class="n">hlsearch</span>
<span class="nb">set</span> <span class="n">incsearch</span>
<span class="nb">set</span> <span class="n">magic</span>
<span class="nb">set</span> <span class="n">showmatch</span>
<span class="nb">set</span> <span class="n">mat</span><span class="o">=</span><span class="mi">2</span>
<span class="nb">set</span> <span class="n">expandtab</span>
<span class="nb">set</span> <span class="n">smarttab</span>
<span class="nb">set</span> <span class="n">shiftwidth</span><span class="o">=</span><span class="mi">4</span>
<span class="nb">set</span> <span class="n">tabstop</span><span class="o">=</span><span class="mi">4</span>
<span class="nb">set</span> <span class="n">lbr</span>
<span class="nb">set</span> <span class="n">tw</span><span class="o">=</span><span class="mi">500</span>
<span class="nb">set</span> <span class="n">ai</span>
<span class="nb">set</span> <span class="n">si</span>
<span class="nb">set</span> <span class="n">wrap</span>
<span class="nb">set</span> <span class="n">paste</span>
<span class="nb">set</span> <span class="n">background</span><span class="o">=</span><span class="n">dark</span>
<span class="n">vnoremap</span> <span class="o">&lt;</span><span class="n">silent</span><span class="o">&gt;</span> <span class="o">*</span> <span class="p">:</span><span class="n">call</span> <span class="n">VisualSelection</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span><span class="o">&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
<span class="n">vnoremap</span> <span class="o">&lt;</span><span class="n">silent</span><span class="o">&gt;</span> <span class="c1"># :call VisualSelection(&#39;b&#39;)&lt;CR&gt;</span>
</pre></div>
</div>
<p>it will customize vim a bit, so it will be easier to edit files in it.</p>
</section>
<section id="journaling">
<h3>Journaling<a class="headerlink" href="#journaling" title="Permalink to this heading">¶</a></h3>
<p>Journaling is one of the most important things you need to have. It just
record everything systemd does. It is part of <code class="docutils literal notranslate"><span class="pre">systemd</span></code> quite
customizable. We will save journals in memory, because of limited wear
of SD cards. We will also compress them and then limit size for them on
40 MB.</p>
<p>Open file <code class="docutils literal notranslate"><span class="pre">/etc/system/journal.conf</span></code> and uncomment these lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Journal</span><span class="p">]</span>
<span class="n">Storage</span><span class="o">=</span><span class="n">volatile</span>
<span class="n">Compress</span><span class="o">=</span><span class="n">yes</span>
<span class="o">...</span>
<span class="n">RuntimeMaxUse</span><span class="o">=</span><span class="mi">40</span><span class="n">M</span>
</pre></div>
</div>
</section>
</section>
<section id="network-configuration">
<h2>Network configuration<a class="headerlink" href="#network-configuration" title="Permalink to this heading">¶</a></h2>
<p>For reasons I will mention in future, we need to set RPi to connect with
<strong>static ip</strong>. This will assure that the IP address of RPi will be still
the same and you can connect it. Right now is probably getting
automatically assigned IP address from router (it’s called <strong>dhcp</strong>).</p>
<p>We will use <code class="docutils literal notranslate"><span class="pre">systemd-networkd</span></code>.</p>
<p>Type <code class="docutils literal notranslate"><span class="pre">ip</span> <span class="pre">addr</span></code>. It should shows something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">:</span> <span class="n">lo</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">LOOPBACK</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">65536</span> <span class="n">qdisc</span> <span class="n">noqueue</span> <span class="n">state</span> <span class="n">UNKNOWN</span> <span class="n">group</span> <span class="n">default</span>
    <span class="n">link</span><span class="o">/</span><span class="n">loopback</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">brd</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
    <span class="n">inet</span> <span class="mf">127.0.0.1</span><span class="o">/</span><span class="mi">8</span> <span class="n">scope</span> <span class="n">host</span> <span class="n">lo</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">ifb0</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">NOARP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">noop</span> <span class="n">state</span> <span class="n">DOWN</span> <span class="n">group</span> <span class="n">default</span> <span class="n">qlen</span> <span class="mi">32</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">22</span><span class="p">:</span><span class="mi">2</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">5</span><span class="n">b</span><span class="p">:</span><span class="mi">8</span><span class="n">e</span><span class="p">:</span><span class="n">b0</span> <span class="n">brd</span> <span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">ifb1</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">NOARP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">noop</span> <span class="n">state</span> <span class="n">DOWN</span> <span class="n">group</span> <span class="n">default</span> <span class="n">qlen</span> <span class="mi">32</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="mi">6</span><span class="n">a</span><span class="p">:</span><span class="mi">68</span><span class="p">:</span><span class="n">fb</span><span class="p">:</span><span class="mi">64</span><span class="p">:</span><span class="mi">2</span><span class="n">f</span><span class="p">:</span><span class="n">c3</span> <span class="n">brd</span> <span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">eth0</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span> <span class="n">mtu</span> <span class="mi">1500</span> <span class="n">qdisc</span> <span class="n">pfifo_fast</span> <span class="n">state</span> <span class="n">UP</span> <span class="n">group</span> <span class="n">default</span> <span class="n">qlen</span> <span class="mi">1000</span>
    <span class="n">link</span><span class="o">/</span><span class="n">ether</span> <span class="n">b8</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="n">eb</span><span class="p">:</span><span class="mi">2</span><span class="n">d</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">18</span> <span class="n">brd</span> <span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span><span class="p">:</span><span class="n">ff</span>
    <span class="n">inet</span> <span class="mf">192.168.0.201</span><span class="o">/</span><span class="mi">24</span> <span class="n">brd</span> <span class="mf">192.168.0.255</span> <span class="n">scope</span> <span class="k">global</span> <span class="n">eth0</span>
       <span class="n">valid_lft</span> <span class="n">forever</span> <span class="n">preferred_lft</span> <span class="n">forever</span>
</pre></div>
</div>
<p>you are interested just in name <strong>eth0</strong>. If it is there, it is ok. In
future versions of system it can change to something other, for example
<em>enp0s1</em>. Don’t be afraid of it and just use that instead in next
chapters.</p>
<p>In this part you’ll need to get address of your router. <a class="reference external" href="http://compnetworking.about.com/od/workingwithipaddresses/f/getrouteripaddr.htm">How to obtain
it</a>?</p>
<p>And how to choose static address? As you know your
router is assigning IP address automatically (it is called DHCP). But
not randomly in full range. It has some range of IP addresses which it
can assign. Standard is this: router has standard IP adress
<code class="docutils literal notranslate"><span class="pre">192.168.0.1</span></code> and assign addresses from <code class="docutils literal notranslate"><span class="pre">192.168.0.2</span></code> to
<code class="docutils literal notranslate"><span class="pre">192.168.0.254</span></code>. Second standard is <code class="docutils literal notranslate"><span class="pre">10.0.0.138</span></code> for router and it
assignes addresses from <code class="docutils literal notranslate"><span class="pre">10.0.0.139</span></code> to <code class="docutils literal notranslate"><span class="pre">10.0.0.254</span></code>. But it <em>can</em>
be anything else.</p>
<p>Interesting - and what the hell should you do that? I suggest to set one
the address on the end from this range. You can notice, that my “eth0”
has IP address <code class="docutils literal notranslate"><span class="pre">192.168.0.201</span></code>.</p>
<p>Open this file <code class="docutils literal notranslate"><span class="pre">/etc/systemd/network/ethernet_static.network</span></code> (how?
just use <code class="docutils literal notranslate"><span class="pre">vim</span></code> as in the previous - but don’t forgot to use <code class="docutils literal notranslate"><span class="pre">sudo</span></code>
in front of <code class="docutils literal notranslate"><span class="pre">vim</span></code>, or you’ll not be able to save it!) and paste this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Match</span><span class="p">]</span>
<span class="n">Name</span><span class="o">=</span><span class="n">eth0</span>

<span class="p">[</span><span class="n">Network</span><span class="p">]</span>
<span class="n">Address</span><span class="o">=</span><span class="n">the</span><span class="o">.</span><span class="n">static</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">rpi</span><span class="o">/</span><span class="mi">24</span>
<span class="n">Gateway</span><span class="o">=</span><span class="n">your</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">ip</span><span class="o">.</span><span class="n">address</span>
</pre></div>
</div>
<p>my example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Match</span><span class="p">]</span>
<span class="n">Name</span><span class="o">=</span><span class="n">eth0</span>

<span class="p">[</span><span class="n">Network</span><span class="p">]</span>
<span class="n">Address</span><span class="o">=</span><span class="mf">192.168.0.111</span><span class="o">/</span><span class="mi">24</span>
<span class="n">Gateway</span><span class="o">=</span><span class="mf">192.168.0.1</span>
</pre></div>
</div>
<p>Now you need to remove old non-static default profile <code class="docutils literal notranslate"><span class="pre">/etc/systemd/network/eth0.network</span></code>. Move it to your home folder just to be safe if something didn’t work.</p>
<p>Try to restart RPi and try to SSH again. If you just can’t connect, try to find out if RPi hadn’t connected at all or it just doesn’t use IP specified IP address (try to ssh to old IP, look into your router DHCP table, nmap…). If you want to get it back, just turn off RPi (plug off the power cable), take out SD card, plug in to your PC, move <code class="docutils literal notranslate"><span class="pre">eth0.network</span></code> from home directory to <code class="docutils literal notranslate"><span class="pre">/etc/systemd/network/</span></code>, turn RPi back and try it again.</p>
<p>If you successfuly connected, check how is <code class="docutils literal notranslate"><span class="pre">systemd-networkd</span></code> doing. To find out, type: <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">status</span> <span class="pre">systemd-networkd</span></code>. Does it
shows “active (running)” and something like <code class="docutils literal notranslate"><span class="pre">gained</span> <span class="pre">carrier</span></code>?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">â</span> <span class="n">systemd</span><span class="o">-</span><span class="n">networkd</span><span class="o">.</span><span class="n">service</span> <span class="o">-</span> <span class="n">Network</span> <span class="n">Service</span>
   <span class="n">Loaded</span><span class="p">:</span> <span class="n">loaded</span> <span class="p">(</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">systemd</span><span class="o">-</span><span class="n">networkd</span><span class="o">.</span><span class="n">service</span><span class="p">;</span> <span class="n">enabled</span><span class="p">)</span>
   <span class="n">Active</span><span class="p">:</span> <span class="n">active</span> <span class="p">(</span><span class="n">running</span><span class="p">)</span> <span class="n">since</span> <span class="n">Wed</span> <span class="mi">2014</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">42</span><span class="p">:</span><span class="mi">13</span> <span class="n">CEST</span><span class="p">;</span> <span class="mi">2</span> <span class="n">weeks</span> <span class="mi">1</span> <span class="n">days</span> <span class="n">ago</span>
     <span class="n">Docs</span><span class="p">:</span> <span class="n">man</span><span class="p">:</span><span class="n">systemd</span><span class="o">-</span><span class="n">networkd</span><span class="o">.</span><span class="n">service</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
 <span class="n">Main</span> <span class="n">PID</span><span class="p">:</span> <span class="mi">213</span> <span class="p">(</span><span class="n">systemd</span><span class="o">-</span><span class="n">network</span><span class="p">)</span>
   <span class="n">Status</span><span class="p">:</span> <span class="s2">&quot;Processing requests...&quot;</span>
   <span class="n">CGroup</span><span class="p">:</span> <span class="o">/</span><span class="n">system</span><span class="o">.</span><span class="n">slice</span><span class="o">/</span><span class="n">systemd</span><span class="o">-</span><span class="n">networkd</span><span class="o">.</span><span class="n">service</span>
           <span class="n">ââ213</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">systemd</span><span class="o">-</span><span class="n">networkd</span>

<span class="n">Jun</span> <span class="mi">17</span> <span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">01</span> <span class="n">smecpi</span> <span class="n">systemd</span><span class="o">-</span><span class="n">networkd</span><span class="p">[</span><span class="mi">213</span><span class="p">]:</span>             <span class="n">eth0</span><span class="p">:</span> <span class="n">lost</span> <span class="n">carrier</span>
<span class="n">Jun</span> <span class="mi">17</span> <span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">02</span> <span class="n">smecpi</span> <span class="n">systemd</span><span class="o">-</span><span class="n">networkd</span><span class="p">[</span><span class="mi">213</span><span class="p">]:</span>             <span class="n">eth0</span><span class="p">:</span> <span class="n">gained</span> <span class="n">carrier</span>
</pre></div>
</div>
</section>
<section id="timesynchronization">
<h2>Timesynchronization<a class="headerlink" href="#timesynchronization" title="Permalink to this heading">¶</a></h2>
<p>You’ve maybe noticed that time is quite weird on your RPi. It is beacuse
it does not have real hardware clock. Every time RPi is waken up, it
thinks that is June 1970. You don’t have to care about it, but after
boot it would be fine that time is correctly set. You can do it by using
really great part of <code class="docutils literal notranslate"><span class="pre">systemd</span></code>. Go ahead and check service that
takes care about that: <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">status</span> <span class="pre">systemd-timesyncd</span></code>.</p>
</section>
<section id="configuring-ssh">
<h2>Configuring SSH<a class="headerlink" href="#configuring-ssh" title="Permalink to this heading">¶</a></h2>
<p>We will open RPi to world and in that case we need to secure it a bit.
Service, which takes care about SSH is called <code class="docutils literal notranslate"><span class="pre">sshd</span></code>. “Where” it is?
It is runned by systemd, so <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">status</span> <span class="pre">sshd</span></code> will show you some
info :). We will configure it a bit. This is not necessary, but highly
recommended! Brutal force attacks are really common (hundreds every day
on my little unimportant server).</p>
<p>Open file <code class="docutils literal notranslate"><span class="pre">/etc/ssh/sshd_config</span></code> and edit or add these lines as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Port</span> <span class="mi">1234</span>
<span class="n">PermitRootLogin</span> <span class="n">no</span>
<span class="n">PubkeyAuthentication</span> <span class="n">yes</span>
</pre></div>
</div>
<p>that’t enough. Restart sshd <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">restart</span> <span class="pre">sshd</span></code>.</p>
<p>Since now, you cannot login as a root by ssh and thats good. Also - we
changed the port of ssh. Think about “port” as a tunnel, which is used
for ssh. There are about 60 thousands of them and you can choose
whatever you want. As default there is port <strong>22</strong> used for ssh. We now
changed that to (example) 1234. It is because on port 22 there is to big
chance that someone will try to brutal force your credentials.</p>
<p>Since now, only <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">bob&#64;ipadress</span></code> is not enough. You will have to add
port which should be used (in default is assumed port 22).
<code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">-p</span> <span class="pre">1234</span> <span class="pre">bob&#64;ip.address</span></code> will do it for you :) .</p>
<p>If you want to be really safe, the next thing you want to do is set up <code class="docutils literal notranslate"><span class="pre">sshguard</span></code>. More about it
<a class="reference external" href="https://wiki.ArchLinux.org/index.php/Sshguard">here</a>. You don’t need
more :) . Just remember to use your port (in my case 1234) for settings. Personally I stopped to use it, since just changing port what SSH use was enough to reduce uninvited connections.</p>
<p>It is anoying still typing same username and password when we want to
connect to RPi. And now, we have to add “-p 1234” also. We will make it
automatic. <a class="reference external" href="http://www.linuxproblem.org/art_9.html">Here</a> is quite
good guide how to do it. On PC from which you are connecting (no RPi),
edit <code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code> to this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Host</span> <span class="n">my_superpc</span>
  <span class="n">HostName</span> <span class="n">ipaddressofRPi</span>
  <span class="n">IdentityFile</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">yourusername</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">name_of_identityfile</span>
  <span class="n">User</span> <span class="n">bob</span>
  <span class="n">port</span> <span class="mi">1234</span>
</pre></div>
</div>
<p>since now, when you wan’t to connect to RPi you can just type
<code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">my_superpc</span></code> and it will take care about rest.</p>
<p><strong>Screen</strong></p>
<p>You can live without that, but you shouldn’t! It makes you
more productive and you don’t need to be afraid of some mishmash caused
by accidently closing terminal during update or lossing connection.
Learn more about what the screen is
(<a class="reference external" href="http://www.tecmint.com/screen-command-examples-to-manage-linux-terminals/">here</a>,
<a class="reference external" href="https://wiki.ArchLinux.org/index.php/GNU_Screen">here</a> and
<a class="reference external" href="http://www.thegeekstuff.com/2010/07/screen-command-examples/">here</a>),
install it (<code class="docutils literal notranslate"><span class="pre">pacman</span> <span class="pre">-S</span> <span class="pre">screen</span></code>), use it and love it.</p>
<p>It can be handy to automatically ssh into screen sesion. For that I use
this command (from PC I want to connect to RPi):</p>
<p><code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">my_superpc</span> <span class="pre">-t</span> <span class="pre">screen</span> <span class="pre">-dRS</span> <span class="pre">&quot;mainScreen&quot;</span></code>. You can make some alias
to something shorter (for example adding this to
<code class="docutils literal notranslate"><span class="pre">alias</span> <span class="pre">ssh_connect_RPI=&quot;ssh</span> <span class="pre">my_superpc</span>&#160; <span class="pre">-t</span> <span class="pre">screen</span> <span class="pre">-dRUS</span> <span class="pre">mainScreen&quot;</span></code>
in .zshrc). Now all you need to do is type <code class="docutils literal notranslate"><span class="pre">ssh_connect_RPI</span></code> - it here
is now screen created, it will create new one. If it is, it will attach
it.</p>
</section>
<section id="speeding-rpi-up">
<h2>Speeding RPi up<a class="headerlink" href="#speeding-rpi-up" title="Permalink to this heading">¶</a></h2>
<p>Arch Linux ARM for RPi is prepared to be tweaked. And now it is possible
to speed RPi up by overclocking it’s processor without avoiding your
waranty. How to do it? Just edit file <code class="docutils literal notranslate"><span class="pre">/boot/config.txt</span></code> and find this
part:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##None</span>
<span class="n">arm_freq</span><span class="o">=</span><span class="mi">700</span>
<span class="n">core_freq</span><span class="o">=</span><span class="mi">250</span>
<span class="n">sdram_freq</span><span class="o">=</span><span class="mi">400</span>
<span class="n">over_voltage</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<p>now comment it out. That means to add “<strong>#</strong>” in front of every line.
From now, it will be treated as text and not command. It will look like
this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##None</span>
<span class="c1">#arm_freq=700</span>
<span class="c1">#core_freq=250</span>
<span class="c1">#sdram_freq=400</span>
<span class="c1">#over_voltage=0</span>
</pre></div>
</div>
<p>and now uncoment this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##Turbo</span>
<span class="n">arm_freq</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">core_freq</span><span class="o">=</span><span class="mi">500</span>
<span class="n">sdram_freq</span><span class="o">=</span><span class="mi">500</span>
<span class="n">over_voltage</span><span class="o">=</span><span class="mi">6</span>
</pre></div>
</div>
<p>After next boot your RPi will be able to get even to the 1000 MHz. That
means it is faster.</p>
</section>
<section id="other-tweaks-of-boot-config-txt">
<h2>Other tweaks of /boot/config.txt<a class="headerlink" href="#other-tweaks-of-boot-config-txt" title="Permalink to this heading">¶</a></h2>
<p>Since you don’t need any of gpu memory - which cares about shiny things
like windows etc., you can disable it in favor of the rest of memory
which we use. Don’t do this if you want to use monitor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gpu_mem</span><span class="o">=</span><span class="mi">16</span>
<span class="c1">#gpu_mem_512=316</span>
<span class="c1">#gpu_mem_256=128</span>
<span class="c1">#cma_lwm=16</span>
<span class="c1">#cma_hwm=32</span>
<span class="c1">#cma_offline_start=16</span>
</pre></div>
</div>
</section>
<section id="making-rpi-visible-from-outside">
<h2>Making RPi visible from outside<a class="headerlink" href="#making-rpi-visible-from-outside" title="Permalink to this heading">¶</a></h2>
<p>Now we need to configure access from outside. You will need to configure
you router. You have to make a “port forwarding”. Remember port from
ssh? I told you to think about them as a tunnels. These tunnels are also
handy when you need to find out what is on there end.</p>
<p>What we will do here is this: We want to be able from anywhere on the
internet connect to our RPi server.</p>
<p>Example? <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">-p</span> <span class="pre">1234</span> <span class="pre">bob&#64;what.the.hell.is.here</span></code>. You know? There is
definetely not your local address (the one with 192.168…). There must
be your “public” IP address (more about this in <strong>Domains</strong> - take a
look there). But this public address points to your router (if you are
lucky). Where does it go next?</p>
<p>With every request there is also a port. With command <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">smt</span></code>, you
are sending username, port (standard 22, if not otherwise stated) and IP
address. Ip address redirect it to router. Now router takes <strong>port</strong> and
looks to it’s internal database. In this database are pairs: <strong>port</strong> -
<strong>internal_ipaddress</strong>. For some port there is IP address, which it
redirects to. In another worlds: if router gets some request from
specific port (say, 1234) and it has in it’s database IP address</p>
<p>to which it has to redirect, it redirects this request there. In our
case, we need to redirect these ports we want (for example 1234 for ssh)
to RPi. So find a port forwarding settings for your router
(<a class="reference external" href="http://portforward.com/">this</a> might be helpful) and set there port
forward from port you setted for ssh to RPi. You can check if your port
is open (it means it accepts requests
<a class="reference external" href="http://www.yougetsignal.com/tools/open-ports/">here</a>.</p>
<p>Since now, you can ssh from anywhere.</p>
</section>
<section id="webserver">
<h2>Webserver<a class="headerlink" href="#webserver" title="Permalink to this heading">¶</a></h2>
<section id="setting-up-nginx">
<h3>Setting up nginx<a class="headerlink" href="#setting-up-nginx" title="Permalink to this heading">¶</a></h3>
<p>Similiar to <code class="docutils literal notranslate"><span class="pre">ssh</span></code> handling <em>sshish</em> requests, Nginx is handling almost
everything else and even… <strong>WebServers</strong>! Install nginx with
<code class="docutils literal notranslate"><span class="pre">pacman</span> <span class="pre">-S</span> <span class="pre">nginx</span></code>. For security reasons create special user for it,
for example using: <code class="docutils literal notranslate"><span class="pre">useradd</span> <span class="pre">-m</span> <span class="pre">-G</span> <span class="pre">wheel</span> <span class="pre">-s</span> <span class="pre">/usr/bin/zsh</span> <span class="pre">nginx</span></code> and
also group <code class="docutils literal notranslate"><span class="pre">groupadd</span> <span class="pre">webdata</span></code>. Now create some folder for it. It can
be <code class="docutils literal notranslate"><span class="pre">mkdir</span> <span class="pre">/var/www/</span></code> and now make them owners
<code class="docutils literal notranslate"><span class="pre">chown</span> <span class="pre">nginx:webdata</span> <span class="pre">/var/www</span></code>. Of course, enable and start nginx.</p>
<p><code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">enable</span> <span class="pre">nginx</span></code>. It will start after boot.</p>
<p>Now port forward port number 80 to RPi on your router.</p>
<p>Open <code class="docutils literal notranslate"><span class="pre">/etc/nginx/nginx.conf</span></code>, it can looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user nginx;
worker_processes  1;

error_log  /var/log/nginx/error.log warn;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    server_names_hash_bucket_size 64;

    sendfile        on;

    keepalive_timeout  15;

    server{
        listen  80;
        server_name ~^xxx.xxx.xxx.xxx(.*)$;

        location / {
            root   /var/www/$1;
            index  index.html index.htm;
        }
    }

}
</pre></div>
</div>
<p>next, create <code class="docutils literal notranslate"><span class="pre">/var/www/test/index.html</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Sample</span> <span class="s2">&quot;Hello, World&quot;</span> <span class="n">Application</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">body</span> <span class="n">bgcolor</span><span class="o">=</span><span class="n">white</span><span class="o">&gt;</span>

    <span class="o">&lt;</span><span class="n">table</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">cellpadding</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">Sample</span> <span class="s2">&quot;Hello, World&quot;</span> <span class="n">Application</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">table</span><span class="o">&gt;</span>

    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">This</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">home</span> <span class="n">page</span> <span class="k">for</span> <span class="n">the</span> <span class="n">HelloWorld</span> <span class="n">Web</span> <span class="n">application</span><span class="o">.</span> <span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">To</span> <span class="n">prove</span> <span class="n">that</span> <span class="n">they</span> <span class="n">work</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">execute</span> <span class="n">either</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">links</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="n">To</span> <span class="n">a</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="o">&gt;</span><span class="n">JSP</span> <span class="n">page</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;.</span>
      <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="n">To</span> <span class="n">a</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="o">&gt;</span><span class="n">servlet</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;.</span>
    <span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>

  <span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>where xxx.xxx.xxx.xxx should be your public address. This will do this:
when you type in your browser “youripaddress/test:80”, you should see
index Hello world example. Try that without <code class="docutils literal notranslate"><span class="pre">:80</span></code> - it will do the
same! Default port for webpages is <strong>80</strong> (similiar to 22 for SSH). So
it can be omited.</p>
<section id="ftp">
<h4>FTP<a class="headerlink" href="#ftp" title="Permalink to this heading">¶</a></h4>
<p>This will cover the most easy solution for FTP. Don’t use this
configuration in real, just for test purpouses. If you didn’t download
<code class="docutils literal notranslate"><span class="pre">vsftp</span></code>, do it now by <code class="docutils literal notranslate"><span class="pre">pacman</span> <span class="pre">-S</span> <span class="pre">vsftp</span></code>. Now we will create some
directory where all files and users will end up after connecting. Let it
be in <code class="docutils literal notranslate"><span class="pre">/var/www/test</span></code>. Now edit <code class="docutils literal notranslate"><span class="pre">/etc/vsftpd.conf</span></code> and add on the
top this line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">anon_root</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">test</span>
</pre></div>
</div>
<p>and make sure that this line is uncommented:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">anonymous_enable</span><span class="o">=</span><span class="n">YES</span>
</pre></div>
</div>
<p>and just start it: <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">start</span> <span class="pre">vsftpd</span></code>.</p>
<p>Now we’ll tell nginx about that. Add this to servers confs in
<code class="docutils literal notranslate"><span class="pre">/etc/nginx/nginx.conf</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>server{
    listen  80;
    server_name ~^123.123.32.13(.*)$;
    location / {
        ssi on;
        root   /var/www/$1;
        index  index.html index.htm;
    }
}
</pre></div>
</div>
<p>where you need to replace IP address in <code class="docutils literal notranslate"><span class="pre">server_name</span></code> directive to
your public IP.</p>
<p>What this little configuration does? It’s simple. Every time you type to
your brower your IP address and somthing behind it, it will transfer you
to this “something” in /var/www/.</p>
<p><strong>Example</strong> I created index.html here <code class="docutils literal notranslate"><span class="pre">/var/www/example/index.html</span></code>. I
now type <code class="docutils literal notranslate"><span class="pre">123.123.32.13/test</span></code> to my browser and voila!</p>
<p>This nginx configuration isn’t neccessary in our ftp example (it could
be simpler), but I just like it…</p>
<p>You can now connect to ftp by typing this in your browser:
<code class="docutils literal notranslate"><span class="pre">ftp://your_ip_address</span></code> or use your favorite FTP client (e.g.
<code class="docutils literal notranslate"><span class="pre">filezilla</span></code>).</p>
<p><strong>CAUTION</strong> - again, don’t use this settings as default. There are great
guides on the internet how to grant access only some users, password
protected etc.</p>
</section>
</section>
</section>
<section id="system-analyzing-and-cleaning">
<h2>System analyzing and cleaning<a class="headerlink" href="#system-analyzing-and-cleaning" title="Permalink to this heading">¶</a></h2>
<p>Use your friend <code class="docutils literal notranslate"><span class="pre">systemd-analyze</span></code>. It will show you which units
load really long time. Also <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">status</span></code> is great for finding failed
units.</p>
<section id="disable-things-that-you-dont-need">
<h3>Disable things that you dont need<a class="headerlink" href="#disable-things-that-you-dont-need" title="Permalink to this heading">¶</a></h3>
<p>I guess you don’t use ipv6 (if you don’t know what it is, you don’t need
it :D). <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">disable</span> <span class="pre">ip6tables</span></code>. In case you use sshguard, you
need also edit file <code class="docutils literal notranslate"><span class="pre">/cat</span> <span class="pre">/usr/lib/systemd/system/sshguard.service</span></code>
and from <strong>Wants</strong> delete <code class="docutils literal notranslate"><span class="pre">ip6tables.service</span></code>.</p>
</section>
</section>
<section id="usefull-utilites">
<h2>Usefull utilites<a class="headerlink" href="#usefull-utilites" title="Permalink to this heading">¶</a></h2>
<p>Simple to use, just install them and run:</p>
<ul class="simple">
<li><p>nmon - for internet usage</p></li>
<li><p>htop - for disk usage</p></li>
</ul>
<section id="torrents">
<h3>Torrents<a class="headerlink" href="#torrents" title="Permalink to this heading">¶</a></h3>
<p>Your RPi is maybe running 24/7, so why not to use it for torrents? But
how, when there is no GUI? It’s pretty simple. We will use transmission
- popular torrent client. Install it by <code class="docutils literal notranslate"><span class="pre">pacman</span> <span class="pre">-S</span> <span class="pre">transmission-cli</span></code>
Installation should create a new user and group, called transmission. To
check that, you can take a look to <code class="docutils literal notranslate"><span class="pre">/etc/passwd</span></code> and <code class="docutils literal notranslate"><span class="pre">/etc/group</span></code>.
<code class="docutils literal notranslate"><span class="pre">transmission</span></code> will be runned by <code class="docutils literal notranslate"><span class="pre">systemd</span></code>. Let’s see it it’s
service file is configured properly. Check
<code class="docutils literal notranslate"><span class="pre">/usr/lib/systemd/system/transmission.service</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Unit]
Description=Transmission BitTorrent Daemon
After=network.target

[Service]
User=transmission
Type=notify
ExecStart=/usr/bin/transmission-daemon -f --log-error
ExecReload=/bin/kill -s HUP $MAINPID

[Install]
WantedBy=multi-user.target
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">User=transmission</span></code> is important here (for security reasons). Next
thing we need to do is check, if transmission has place where it will
live. By default it is in <code class="docutils literal notranslate"><span class="pre">/var/lib/transmission(-daemon)</span></code>. In this
dir should be also config file <code class="docutils literal notranslate"><span class="pre">settings.json</span></code>. There lays
configuration for it.Edit it ass you wish. It is covered
<a class="reference external" href="https://trac.transmissionbt.com/wiki/ConfigFiles">here</a> and
<a class="reference external" href="https://trac.transmissionbt.com/wiki/EditConfigFiles">here</a>. Maybe
you’ll need to forward ports as we did in previous chapters, you should
make that again without problems :) . No we can run <code class="docutils literal notranslate"><span class="pre">transmission</span></code>
daemon by <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">start</span> <span class="pre">transmission</span></code>. Now you can give it commands
using transmission-remote . The most usefull (and that’s all I need to
know and use :) ) are these:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">transmission-remote</span> <span class="pre">&lt;port&gt;</span> <span class="pre">-a</span> <span class="pre">&quot;magnetlink/url&quot;</span></code> - adds torrent and
starts download it</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transmission-remote</span> <span class="pre">&lt;port&gt;</span> <span class="pre">-l</span></code> - list all torrents that are
currently running</p></li>
</ul>
<p>files should be stored in <code class="docutils literal notranslate"><span class="pre">/var/lib/transmission/Downloads</span></code>. It can be
configured in config file :) .</p>
</section>
</section>
<section id="backups">
<h2>Backups<a class="headerlink" href="#backups" title="Permalink to this heading">¶</a></h2>
<p>For backups I choosed <code class="docutils literal notranslate"><span class="pre">rdiff-backup</span></code>. It’s so stupid but works
(almost) as expected. More about it’s usage you can find in it’s manual
pages. For my example I’ll redirect you to dir with configs in this
repo. These are inserted to <code class="docutils literal notranslate"><span class="pre">cron</span></code> (you have it by default installed)
to do SSH backup every day in 4AM. If I’m on local network I also do
backup to my disc on other PC.</p>
</section>
<section id="final">
<h2>Final<a class="headerlink" href="#final" title="Permalink to this heading">¶</a></h2>
<p>That’s all for now! I will see if this is used by someone and than I
will see if I will continue.</p>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>RPi don’t boot - unplug everything from USB ports (there may be not
enough of power to boot up and supply USB)</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Making Raspberry Pi usable</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#what-you-get">What you get</a></li>
<li><a class="reference internal" href="#what-you-will-need">What you will need</a></li>
<li><a class="reference internal" href="#what-you-don-t-need">What you don’t need</a></li>
<li><a class="reference internal" href="#start">Start</a><ul>
<li><a class="reference internal" href="#installing-arch-linux-arm-to-sd-card">Installing Arch Linux ARM to SD card</a></li>
<li><a class="reference internal" href="#little-networking">Little networking</a></li>
</ul>
</li>
<li><a class="reference internal" href="#first-setup">First setup</a></li>
<li><a class="reference internal" href="#installing-some-sugar-candy">Installing some sugar candy</a></li>
<li><a class="reference internal" href="#some-configurations">Some configurations</a><ul>
<li><a class="reference internal" href="#make-vim-usable">Make vim usable</a></li>
<li><a class="reference internal" href="#journaling">Journaling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#network-configuration">Network configuration</a></li>
<li><a class="reference internal" href="#timesynchronization">Timesynchronization</a></li>
<li><a class="reference internal" href="#configuring-ssh">Configuring SSH</a></li>
<li><a class="reference internal" href="#speeding-rpi-up">Speeding RPi up</a></li>
<li><a class="reference internal" href="#other-tweaks-of-boot-config-txt">Other tweaks of /boot/config.txt</a></li>
<li><a class="reference internal" href="#making-rpi-visible-from-outside">Making RPi visible from outside</a></li>
<li><a class="reference internal" href="#webserver">Webserver</a><ul>
<li><a class="reference internal" href="#setting-up-nginx">Setting up nginx</a><ul>
<li><a class="reference internal" href="#ftp">FTP</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#system-analyzing-and-cleaning">System analyzing and cleaning</a><ul>
<li><a class="reference internal" href="#disable-things-that-you-dont-need">Disable things that you dont need</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usefull-utilites">Usefull utilites</a><ul>
<li><a class="reference internal" href="#torrents">Torrents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backups">Backups</a></li>
<li><a class="reference internal" href="#final">Final</a></li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="Arch.html"
                          title="previous chapter">Installing Arch Linux on laptop and how to make it usable</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="git_rtd.html"
                          title="next chapter">Simple GitHub repo and ReadTheDocs set up</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/source/RPi.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="git_rtd.html" title="Simple GitHub repo and ReadTheDocs set up"
             >next</a> |</li>
        <li class="right" >
          <a href="Arch.html" title="Installing Arch Linux on laptop and how to make it usable"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">tutos 0.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Making Raspberry Pi usable</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, kotrfa.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.1.
    </div>
  </body>
</html>